!function(){const t=function(t,s){return window.webkit.messageHandlers.bluetooth.postMessage({action:t,data:s})};class s{constructor(s){this.connect=async()=>{const s=await t("connect",{uuid:this.device.uuid});return this.connected=s.connected,this},this.device=s,this.connected=!1}}class e{constructor(t){this.id=t,this.isEmpty=()=>0===this.targets.length,this.addTarget=(t,s)=>{this.targets.push({name:t,target:s})},this.removeTarget=t=>{this.targets=this.targets.filter((s=>s.name!==t))},this.postMessage=t=>{const s=this.targets.find((s=>s.name===t.type));s&&s.target.dispatchEvent(t)},this.id=t,this.targets=[]}}const i=new class{constructor(){this.addTarget=(t,s,i)=>{let a=this.dispatchers.find((s=>s.id===t));a||(a=new e(t),this.dispatchers.push(a)),a.addTarget(s,i)},this.removeTarget=(t,s)=>{const e=this.dispatchers.find((s=>s.id===t));e&&e.removeTarget(s),e.isEmpty()&&(this.dispatchers=this.dispatchers.filter((s=>s.id!==t)))},this.removeAllTargets=t=>{this.dispatchers=this.dispatchers.filter((s=>s.id!==t))},this.postMessage=(t,s)=>{const e=this.dispatchers.find((s=>s.id===t));e&&e.postMessage(s)},this.dispatchers=[]}};class a extends EventTarget{constructor(t,e){super(),this.uuid=t,this.name=e,this.gatt=new s(this),i.addTarget(t,"gattserverdisconnected",this)}}class n extends EventTarget{constructor(){super(),this.onavailabilitychanged=t=>{},this.getAvailability=async()=>(await t("getAvailability")).isAvailable,this.getDevices=async()=>(await t("getDevices")).map((t=>new a(t.uuid,t.name))),this.requestDevice=async s=>{const e=await t("requestDevice",{options:s});return new a(e.uuid,e.name)},i.addTarget("bluetooth","availabilitychanged",this),this.addEventListener("availabilitychanged",(t=>{this.onavailabilitychanged(t)}))}}class c extends Event{constructor(t,s){super(t,s),this.value=null==s?void 0:s.value}}async function r(){(await window.webkit.messageHandlers.eventsink.postMessage({})).forEach((t=>{const s=new c(t.name,{value:t.data});i.postMessage(t.id,s)}))}void 0===navigator.bluetooth&&(navigator.bluetooth=new n,async function(){for(;;)await r()}())}();
